#!/bin/sh
# Pre-commit hook: Run lint, tests, and coverage checks before committing

echo "ğŸ” Running pre-commit checks..."
echo ""

# 1. Run lint
echo "ğŸ“ Running lint..."
npm run lint
if [ $? -ne 0 ]; then
  echo "âŒ Lint failed. Please fix linting errors before committing."
  exit 1
fi
echo "âœ… Lint passed"
echo ""

# 2. Run all tests
echo "ğŸ§ª Running tests..."
npm run test:run
if [ $? -ne 0 ]; then
  echo "âŒ Tests failed. Please fix failing tests before committing."
  exit 1
fi
echo "âœ… Tests passed"
echo ""

# 3. Check handler test coverage
echo "ğŸ“Š Checking test coverage..."
npm run test:check-coverage
if [ $? -ne 0 ]; then
  echo "âŒ Test coverage check failed. Please add missing tests before committing."
  exit 1
fi
echo "âœ… Test coverage check passed"
echo ""

echo "ğŸ‰ All pre-commit checks passed!"
